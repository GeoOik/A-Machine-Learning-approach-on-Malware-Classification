import pandas as pd
from sklearn.utils import shuffle
from math import ceil
import numpy as np


# file_name=["DDoS.csv","FTP-Patator.csv","Web_Attack.csv",
# "Bot.csv","SSH-Patator.csv","PortScan.csv","DoS_Hulk.csv",
# "DoS_Slowhttptest.csv","Dos_slowloris.csv","DoS_GoldenEye.csv","Normal_Traffic.csv"]


file_name=["DDoS.csv","FTP-Patator.csv","Web_Attack.csv","SSH-Patator.csv","Dos_slowloris.csv","WannaCry.csv","Normal_Traffic.csv"]

# data1.columns = data1.columns.str.strip()
# data1=data1.drop("Unnamed: 0",axis=1)
# data1.to_csv("dataset/DoS_slowloris.csv",index= False)


unseen_frames=[]
i=0
for f in file_name:
	data = pd.read_csv(f)
	data.columns = data.columns.str.strip()
	if "Destination Port" in data.columns:
		del data["Destination Port"]
	if "Fwd Header Length.1" in data.columns:
		del data["Fwd Header Length.1"]	

	data = shuffle(data)

	s=ceil(len(data)*0.25)
	label=data["Label"][0]
	del data["Label"]
	test_data=data[0:s]
	test_data=test_data.replace([np.inf, -np.inf], np.nan).dropna(axis=0)
	test_data=test_data.mask(test_data<0).dropna(axis=0)
	train_data=data[s:]

	train_data=train_data.replace([np.inf, -np.inf], np.nan).dropna(axis=0)
	train_data=train_data.mask(train_data<0).dropna(axis=0)
	train_data["Label"]=label
	test_data["Label"]=label


	unseen_frames.append(test_data)
	train_data.to_csv("dataset/train_"+f,index= False)
	print(f,s)
	i+=1

unseen_data=pd.concat(unseen_frames).reset_index(drop=True)

unseen_data = shuffle(unseen_data)
unseen_data.to_csv("dataset/Mal_test.csv",index= False)
